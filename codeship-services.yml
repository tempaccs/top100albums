app:
  build: .

cypress:
  build:
    dockerfile: cypress/Dockerfile
  depends_on:
  - app

dockercfg-generator:
  image: codeship/aws-ecr-dockercfg-generator
  add_docker: true
  encrypted_env_file:
    - aws.env.encrypted
  environment:
    - AWS_REGION=eu-west-1

awsdeployment:
  image: codeship/aws-deployment
  encrypted_env_file:
    - aws.env.encrypted
  environment:
    - AWS_DEFAULT_REGION=eu-west-1
  volumes:
    - ./:/deploy
